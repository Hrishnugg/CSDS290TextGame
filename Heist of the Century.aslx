<!--Saved by Quest 5.9.9166.36226-->
<asl version="580">
  <include ref="English.aslx" />
  <include ref="Core.aslx" />
  <game name="Heist of the Century">
    <gameid>4be257b7-c6e2-4449-9055-55394a702d93</gameid>
    <version>1.0</version>
    <firstpublished>2026</firstpublished>
    <threat type="int">0</threat>
    <statusattributes type="stringdictionary">
      <item>
        <key>threat</key>
        <value>Threat: !/10</value>
      </item>
    </statusattributes>
    <attr name="autodescription_youarein_useprefix" type="boolean">false</attr>
    <autodescription_youarein_newline />
    <subtitle>A Stealth, Manipulation, and Infiltration Text Adventure Game</subtitle>
    <author>Stephan Jamet, Ares Kittell, Hrishikesh Hari, and Roberto Matthews</author>
    <guardTimer type="int">3</guardTimer>
    <start type="script"><![CDATA[
      game.threat = 0
      msg ("Venice, Italy 1951. <br/><br/>Your name is Dinak Forger, a former Italian nobleman. In 1947 your family was stripped of their nobility status by the ruthless actions of Italian business mogul Guido Giuseppe. Through shady business practices and corruption, Giusseppe has managed to falsify and produce documents to ruin the Forger family’s name, and claim ultimate power over the Italian business scene. <br/><br/>While Giusseppe has won the battle that leading to the demise of your family's legacy, the Forger's story does not end here. You have spent the last four years sturggling to make ends meet. As a result you have resorted to theivery and manipulation in order to survive. <br/><br/>Three years after the demise of your family's name you have uncovered the tool that directly led to the Forger family’s rise to power, the Shkruesiverita.The Shkruesiverita is a powerful pencil that allows the writer to alter any text in the world, be it signs, texts etched in stone, and most importantly to you, legal and business documents to restore your family’s status.<br/><br/>In order to do this, you must find a way into the Giuseppe estate, break into the secured vault, and use the Shkruesiverita to delegitimize the documents responsible for the collapse of your family. Luckily for you, Giusseppe, in his extravagance and narcissism, is holding what is being dubbed \"The Party of the Century” after his rise to the peak of Italian business. This masquerade party presents you with an opportunity to use his skills as a thief, and more importantly the Shkruesiverita, to sneak and manipulate his way through the party and security to get to the Giuseppe Estate’s vault. You will have to deal with the other guests of European nobility, guards and security, and Guido Giusseppe himself to puzzle your way through to the vault. <br/>")
    ]]></start>
    <roomenter type="script">
      if (game.threat = 10) {
        msg ("You are being pursued by guards.")
        msg ("You have 2 actions before the guards catch up.")
        game.guardTimer = 3
      }
    </roomenter>
    <object name="Shining Key">
      <inherit name="editor_object" />
      <look>A shining key, quite hard to hide from anyone looking at you.</look>
      <inventoryverbs type="stringlist">
        <value>Look at</value>
        <value>Use</value>
      </inventoryverbs>
      <drop type="boolean">false</drop>
      <take />
    </object>
  </game>
  <object name="test room">
    <inherit name="editor_room" />
  </object>
  <verb>
    <property>increasethreat</property>
    <pattern>increase threat</pattern>
    <defaultexpression>WriteVerb(game.pov, "can't") + " increase threat " + object.article + "."</defaultexpression>
  </verb>
  <verb>
    <property>checkthreat</property>
    <pattern>check threat</pattern>
    <defaultexpression>WriteVerb(game.pov, "can't") + " check threat " + object.article + "."</defaultexpression>
  </verb>
  <object name="Entrance">
    <inherit name="editor_room" />
    <description><![CDATA[The Entrance to the party.<br/><br/>Europe's most elite and high profile individuals have gathered here to attend what many are dubbing "The Party of the Century". This lavish party is hosted by none other than the titan of Italian business, Guido Giusseppe. <br/><br/>You are at the entrance to the ballroom of his grand estate. You can tell just from the entrance alone that Guido Giuseppe is a very wealthy man. There is a line with many famous, wealthy, and important guests of Italian and other European Nobility. <br/><br/>The guests are lined up awaiting to be let into the festivities. There is a guest check in at the entrance to the ballroom to the north. A guard is stationed there checking all the guests for their invitations to the party.<br/><br/>]]></description>
    <usedefaultprefix />
    <prefix type="string"></prefix>
    <object name="player">
      <inherit name="editor_object" />
      <inherit name="editor_player" />
      <statusattributes type="stringdictionary" />
      <hasPartyInvitation type="boolean">false</hasPartyInvitation>
      <hasCoatTicket type="boolean">false</hasCoatTicket>
      <hasOwnCoat />
      <knowsCoatGuardName type="boolean">false</knowsCoatGuardName>
      <knowsVaultLastDigit type="boolean">false</knowsVaultLastDigit>
      <knowsVaultFirstDigit type="boolean">false</knowsVaultFirstDigit>
      <knowsVaultSecondDigit type="boolean">false</knowsVaultSecondDigit>
      <knowsVaultThirdDigit type="boolean">false</knowsVaultThirdDigit>
      <object name="Shkruesiverita">
        <inherit name="editor_object" />
        <look>The Shkruesiverita is a powerful tool used to alter any text in the world. This tool is what your ancestors used to rise to power. Though thought lost to time, it has found its way to your hands. Use this tool to help navigate, manipulate, and stealth your way through the party to get to the vault and restore your family's status.</look>
        <inventoryverbs type="stringlist">
          <value>Look at</value>
          <value>Use</value>
        </inventoryverbs>
        <drop type="boolean">false</drop>
        <feature_usegive />
        <use />
        <givesingle />
        <selfuseon type="scriptdictionary">
          <item key="Party Invitation">
            if (Party Invitation.changedName) {
              msg ("You already changed the name on the invitation")
            }
            else {
              set (Party Invitation, "changedName", true)
              msg ("You alter the text on the Party Invitation to show your name, Dinak Forger")
            }
          </item>
          <item key="Coat Ticket">
            if (player.knowsCoatGuardName) {
              msg ("You alter the text of the Coat Ticket to show 'Marco Romano'")
              set (Coat Ticket, "altered", true)
            }
            else {
              msg ("You don't know what to change the text to")
            }
          </item>
          <item key="Forger Family Documents"><![CDATA[
            msg ("With the Forger Family Documents finally aquired, you carefully read the contents of them.<br/><br/>You see the lies Guido Giusseppe has spread and the corrupt actions he has taken to lead your family to ruin.<br/><br/>With the Shkruesiverita you go though each document altering their contents...<br/><br/>These documents now have no hold over your family.<br/><br/>In the coming days you challenge Guido Giusseppe's legal victories over your family. Through your appeals, the altered documents are presented in a fair court far from Guido Giuseppe's corrupt hands. The contents of the documents are clearly false and fabricated. You win the case easily. Guido Giuseppe is ordered to pay recompense to your family. In the following months your family's status is restored.<br/><br/>You have completed your objective.")
            finish
          ]]></item>
          <item key="Guest Book"><![CDATA[
            if (Guest Book.isAltered) {
              msg ("You have already altered the guest book.")
            }
            else {
              msg ("You use the Shkruesiverita to add a new entry to the guest book:<br/><br/>\"Inspector Marcello Ricci - Ministry of Cultural Affairs - Conducting Surprise Audit\"<br/><br/>You step back and wait. The guard glances at the book out of habit and his face goes pale.<br/><br/>Gallery Guard: \"An inspector? Here? Now? I must inform Signor Giuseppe immediately!\"<br/><br/>He rushes out of the gallery. The art critic, delighted by the chaos, hurries off to examine other paintings she couldn't access before.<br/><br/>The restricted area is now unguarded.")
              set (Guest Book, "isAltered", true)
              set (Gallery Guard, "isDistracted", true)
            }
          ]]></item>
          <item key="Restricted Painting"><![CDATA[
            if (Gallery Guard.isDistracted) {
              if (Restricted Painting.hasBeenExamined) {
                msg ("You have already revealed the hidden message.")
              }
              else {
                msg ("You use the Shkruesiverita on the painting, focusing on the areas where the brushwork seems uneven...<br/><br/>The magic of the pencil reveals text hidden beneath layers of paint:<br/><br/>\"To my heir: Trust in the family motto. The truth lies beneath the lies. - Grandfather Forger\"<br/><br/>Moved by this message from your grandfather, you examine the frame more carefully and discover a hidden compartment behind it.<br/><br/>Inside you find a Forger Family Signet Ring and a faded letter.")
                set (Restricted Painting, "hasBeenExamined", true)
                AddToInventory (Forger Family Signet Ring)
                AddToInventory (Faded Letter)
              }
            }
            else {
              msg ("You cannot get close enough to the painting with the guard watching. You need to find a way to distract him first.")
            }
          ]]></item>
          <item key="Turmeric Jar"><![CDATA[
            if (Turmeric Jar.isAltered) {
              msg ("You have already changed the label.")
            }
            else {
              msg ("You use the Shkruesiverita to carefully alter the label from 'Turmeric' to 'Saffron'. The powder inside looks convincing enough...")
              set (Turmeric Jar, "isAltered", true)
            }
          ]]></item>
          <item key="Servant's Ledger"><![CDATA[
            if (Servant's Ledger.isAltered) {
              msg ("You have already altered Lucia's entry.")
            }
            else {
              msg ("You use the Shkruesiverita to alter Lucia's entry:<br/><br/>From: \"Lucia Benedetti - Owes: 500 Lira - Interest accruing\"<br/>To: \"Lucia Benedetti - Owes: 0 Lira - PAID IN FULL\"<br/><br/>The ink shimmers and settles into place. As far as this ledger is concerned, Lucia is free.")
              set (Servant's Ledger, "isAltered", true)
            }
          ]]></item>
          <item key="Party Schedule"><![CDATA[
            if (Party Schedule.isAltered) {
              msg ("You have already altered the schedule.")
            }
            else {
              msg ("You use the Shkruesiverita to change the time of the portrait sitting from '11:00 PM' to 'NOW - IMMEDIATELY'.<br/><br/>A servant appears at the door moments later.<br/><br/>Servant: \"Countess Morosini? The artist is ready for your portrait sitting in the Gallery.\"<br/><br/>Countess Valentina: \"What? Already? The schedule said 11:00!\"<br/><br/>Servant: \"I apologize, signora, but the schedule clearly says immediately. The artist is waiting.\"<br/><br/>The Countess huffs indignantly but leaves the room, muttering about incompetent staff.<br/><br/>You are now alone in the bedchamber.")
              set (Party Schedule, "isAltered", true)
              set (Countess Valentina, "isDistracted", true)
            }
          ]]></item>
          <item key="Performance Schedule"><![CDATA[
            if (Performance Schedule.isAltered) {
              msg ("You have already altered the schedule.")
            }
            else {
              msg ("You use the Shkruesiverita to change the performance time to 'NOW - IMMEDIATELY'.<br/><br/>A servant knocks at the door moments later.<br/><br/>Servant: \"Maestro Cardinali? The guests are assembled in the Music Salon for your performance.\"<br/><br/>Maestro Enzo: \"What? Now? But I am not prepared!\"<br/><br/>Servant: \"The schedule says immediately, Maestro. They are waiting.\"<br/><br/>The Maestro grumbles but gathers his violin and shuffles out, muttering about incompetent schedulers.<br/><br/>You are now alone in the bedchamber.")
              set (Performance Schedule, "isAltered", true)
              set (Maestro Enzo, "isDistracted", true)
            }
          ]]></item>
          <item key="Guest Registry Card"><![CDATA[
            if (Guest Registry Card.isAltered) {
              msg ("You have already altered the registry card.")
            }
            else {
              msg ("You use the Shkruesiverita to change 'Chamber 2' to 'Chamber 1'.<br/><br/>You place the card prominently on the nightstand and wait. The Baron eventually glances at it and frowns.<br/><br/>Baron Friedrich: \"Chamber 1? But I thought... No, I must be mistaken. These Italian houses are so confusing.\"<br/><br/>He gathers some of his papers.<br/><br/>Baron Friedrich: \"Excuse me. I must find my correct room.\"<br/><br/>He leaves, looking puzzled. You are now alone in the bedchamber.")
              set (Guest Registry Card, "isAltered", true)
              set (Baron Friedrich, "isDistracted", true)
            }
          ]]></item>
        </selfuseon>
      </object>
      <object name="Coat">
        <inherit name="editor_object" />
        <inventoryverbs type="stringlist">
          <value>Look at</value>
          <value>Use</value>
        </inventoryverbs>
        <look>Your coat.</look>
        <drop type="boolean">false</drop>
      </object>
    </object>
    <object name="Test Threat Increaser">
      <inherit name="editor_object" />
      <displayverbs type="stringlist">
        <value>Increase Threat</value>
        <value>Check Threat</value>
      </displayverbs>
      <useindividualverblist />
      <increasethreat type="script">
        game.threat = game.threat + 15
        msg ("Your threat is: " + game.threat)
      </increasethreat>
      <checkthreat type="script"><![CDATA[
        if (game.threat > 90) {
          msg ("Your threat is larger than 90")
        }
        else if (game.threat > 80) {
          msg ("Your threat is larger than 80")
        }
        else if (game.threat > 70) {
          msg ("Your threat is larger than 70")
        }
        else if (game.threat > 60) {
          msg ("Your threat is larger than 60")
        }
        else if (game.threat > 50) {
          msg ("Your threat is larger than 50")
        }
        else if (game.threat > 40) {
          msg ("Your threat is larger than 40")
        }
        else if (game.threat > 30) {
          msg ("Your threat is larger than 30")
        }
        else if (game.threat > 20) {
          msg ("Your threat is larger than 20")
        }
        else if (game.threat > 10) {
          msg ("Your threat is larger than 10")
        }
        else {
          msg ("Your threat is larger than 0")
        }
      ]]></checkthreat>
    </object>
    <object name="Drunk Nobleman">
      <inherit name="editor_object" />
      <inherit name="male" />
      <isDistracted type="boolean">false</isDistracted>
      <attr name="feature_usegive" type="boolean">false</attr>
      <lookedAt type="boolean">false</lookedAt>
      <look type="script">
        msg ("You see a well-dressed nobleman swaying on his feet. His mask is crooked on his face. He has very cleary had too much to drink. In his pocket, barely staying inside of it, you see what appears to be an invitation to the party.")
        set (Drunk Nobleman, "lookedAt", true)
      </look>
      <speak type="script"><![CDATA[
        msg ("You approach the nobleman He squints at you, barely able to focus.")
        topics = Split ("Are you ok;What is your name;How's the party", ";")
        ShowMenu ("What would you like to do?", topics, false) {
          switch (result) {
            case ("What is your name") {
              msg ("Drunk Nobleman: \"I aM thE greAt ... ALesSanDro BElLinI\"<br/><br/>He sniffles...")
            }
            case ("How's the party") {
              msg ("Drunk Nobleman: ThIs PartY .... is GrEat! .... ThE ChamPagne neVeR sTOps .... fLowing\"<br/><br/>He chuckles...<br/><br/>Drunk Nobleman: \"If oNly i Had some ... MoRe\"")
            }
            case ("Are you ok") {
              msg ("Drunk Nobleman: \"oF coURse I’m fIne… whY wOuLDn’t I be?\"<br/><br/>He burps<br/><br/>Drunk Nobleman: \"I aM at tHE ... grEaT.... ''paRtY oF the CenTurY'.. afteR aLL\"")
            }
          }
        }
      ]]></speak>
      <stealinvitation type="script">
        if (this.isDistracted) {
          msg ("While he is distracted bu the champagne you manage to take the Party Invitation from his pocket")
          AddToInventory (Party Invitation)
        }
        else {
          msg ("You wont be able to take the invitation without distracting him")
        }
      </stealinvitation>
      <steal type="script">
        if (this.lookedAt) {
          if (this.isDistracted) {
            AddToInventory (Party Invitation)
            msg ("You manage to take his personal Party Invitation while he is indulging in the Champagne. It lists his name \"Alessandro Bellini\"")
            set (player, "hasPartyInvitation", true)
          }
          else {
            msg ("You cannot steal the invitation yet.")
          }
        }
        else {
          msg ("You don't know what to steal from him. You might need to look closer at him.")
        }
      </steal>
      <object name="Party Invitation">
        <inherit name="editor_object" />
        <look>A coveted invitation to Guido Giusseppe's 'Party of the Century'. The elites and nobles of Europe all wish to recieve one. It is stamped with the Giusseppe family seal.</look>
        <drop type="boolean">false</drop>
        <changedName type="boolean">false</changedName>
        <inventoryverbs type="stringlist">
          <value>Look at</value>
          <value>Use</value>
        </inventoryverbs>
      </object>
    </object>
    <object name="Champagne Bottle">
      <inherit name="editor_object" />
      <take />
      <look>An expensive looking chanpagne bottle. Guido Giusseppe spares no expense for the drinks at the party. </look>
      <takemsg>You pick up the Champagne Bottle</takemsg>
      <feature_usegive />
      <drop type="boolean">false</drop>
      <inventoryverbs type="stringlist">
        <value>Look at</value>
        <value>Use</value>
        <value>Give</value>
      </inventoryverbs>
      <use type="boolean">false</use>
      <givesingle />
      <givemenuprompt type="string"></givemenuprompt>
      <giveto type="scriptdictionary">
        <item key="Drunk Nobleman"><![CDATA[
          msg ("You give him the Champagne Bottle<br/><br/>Drunk Nobleman: \"moRe CHampAgnE? ... I can'T saY nO to thaT ...\"<br/><br/>He gladly accepts the champagne and is completely distracted by it.")
          Drunk Nobleman.isDistracted = true
          MoveObject (Champagne Bottle, Drunk Nobleman)
        ]]></item>
      </giveto>
    </object>
    <exit name="Main Ballroom Exit" alias="north" to="Main Ballroom">
      <inherit name="northdirection" />
      <locked type="boolean">false</locked>
      <runscript />
      <lockmessage>In order to get into the party you must have an invitation from Guido Giusseppe himself.</lockmessage>
      <scenery type="boolean">false</scenery>
      <script type="script"><![CDATA[
        if (player.hasPartyInvitation) {
          if (Party Invitation.changedName) {
            MovePlayer (Main Ballroom)
          }
          else {
            msg ("With the newly aquired Party Invitation you present it to the guard at the guest check-in.<br/><br/>He takes a moment to look at it.<br/><br/>...<br/><br/>Guard: \"Excuse me sir, I am familiar with the man listed on this invitation. You are not the man listed on this invitation. I am going to have to ask you to leave immediately\"<br/><br/>You quickly apologise and make a quick excuse saying you must have accidentally picked his up when conversing with him.<br/><br/>The guard just scoffs and tells you to leave.<br/><br/>(Threat Level Increased)<br/><br/>You will not be able to enter the Party like this. If only you had an invitation with your name on it.")
            game.threat = game.threat + 1
          }
        }
        else {
          msg ("You cannot enter the party without an invitation")
        }
      ]]></script>
    </exit>
    <object name="Woman">
      <inherit name="editor_object" />
      <inherit name="female" />
      <lookedAt type="boolean">false</lookedAt>
      <speak type="script"><![CDATA[
        msg ("You decide to speak to the woman.")
        topics = Split ("What is your name;What is your profession;How do you know the host", ";")
        ShowMenu ("What would you like to say?", topics, false) {
          switch (result) {
            case ("What is your name") {
              msg ("Woman: \"I am Chiara Benedetti, pleased to meet you\"<br/><br/>She extends her hand out respectfully")
            }
            case ("What is your profession") {
              msg ("Woman: \"I am an actress\", She says in a prideful way<br/><br/>Woman: \"You may have seen some of the films I was in.\"")
            }
            case ("How do you know the host") {
              msg ("Woman: \"Guido Giusseppe is a hard man to escape if you are anyone with status or importance in Italy. He is a benefactor for many of the films I have worked on. He loves to spend his money and stamp his name on anything he can. You can probably tell from this party alone...\"<br/><br/>She scoffs. She studies you carefully...<br/><br/>Woman: \"If I am being honest, I don't really think highly of him. he seems to be much to absorbed with himself.\"")
            }
          }
        }
      ]]></speak>
      <look type="script">
        msg ("You see a well dressed woman at the back of the line. She is clearly someone of wealth or fame as you can tell be her extravagant and elegant dress.")
        set (Woman, "lookedAt", true)
      </look>
      <steal type="script">
        if (this.lookedAt) {
          msg ("You don't notice anything on her that would be worthwhile to steal.")
        }
        else {
          msg ("You havent looked at anything to steal from her.")
        }
      </steal>
    </object>
  </object>
  <object name="Main Ballroom">
    <inherit name="editor_room" />
    <firstenter type="script"><![CDATA[
      msg ("With the altered Party Invitation showing your name, you present it to the guard at the guest check-in.<br/><br/>He takes a moment to look at it.<br/><br/>...<br/><br/>Guard: \"Welcome to the Party Mr. Forger, I hope you enjoy the festivities\"<br/><br/>With that you have successfully made it into the Giusseppe estate.")
    ]]></firstenter>
    <exit alias="south" to="Entrance">
      <inherit name="southdirection" />
    </exit>
    <exit alias="southwest" to="Coat Room">
      <inherit name="southwestdirection" />
    </exit>
    <exit alias="northwest" to="Music Salon">
      <inherit name="northwestdirection" />
    </exit>
    <exit alias="northeast" to="Kitchen">
      <inherit name="northeastdirection" />
    </exit>
    <exit alias="southeast" to="Gallery">
      <inherit name="southeastdirection" />
    </exit>
    <exit alias="up" to="Ballroom Second Floor">
      <inherit name="updirection" />
    </exit>
  </object>
  <object name="Gallery">
    <inherit name="editor_room" />
    <description><![CDATA[A grand gallery displaying Guido Giuseppe's art collection. Paintings in golden frames line the walls, sculptures stand on marble pedestals, and a velvet rope separates visitors from the most valuable pieces in a restricted area.<br/><br/>An {object:Art Critic} examines the works with a discerning eye. A {object:Gallery Guard} stands watch near the restricted section.]]></description>
    <exit alias="northwest" to="Main Ballroom">
      <inherit name="northwestdirection" />
    </exit>
    <object name="Art Critic">
      <inherit name="editor_object" />
      <inherit name="female" />
      <alias>Signora Bianca Ferretti</alias>
      <look>A distinguished woman in her 40s with sharp eyes and an air of expertise. She studies each painting with intense scrutiny, occasionally shaking her head in disapproval.</look>
      <speak type="script"><![CDATA[
        msg ("You approach the art critic. She barely glances at you before returning her gaze to the paintings.")
        topics = Split ("What do you think of the collection;Do you notice anything unusual;Who are you", ";")
        ShowMenu ("What would you like to say?", topics, false) {
          switch (result) {
            case ("What do you think of the collection") {
              msg ("Signora Ferretti: \"Giuseppe has wealth, but not taste. Half of these are copies, and the other half were acquired through... questionable means.\"<br/><br/>She sniffs disdainfully.")
            }
            case ("Do you notice anything unusual") {
              msg ("Signora Ferretti: \"That painting behind the rope - 'The Last Venetian Duke' - it has unusual brushwork. As if someone painted over a hidden message long ago. I would love to examine it closely, but that guard watches it like a hawk.\"")
            }
            case ("Who are you") {
              msg ("Signora Ferretti: \"I am Signora Bianca Ferretti, art critic for the Venetian Gazette. I was invited to write a flattering piece about this collection, but I may have to disappoint our host.\"<br/><br/>She smirks.")
            }
          }
        }
      ]]></speak>
    </object>
    <object name="Gallery Guard">
      <inherit name="editor_object" />
      <inherit name="male" />
      <isDistracted type="boolean">false</isDistracted>
      <look type="script">
        if (this.isDistracted) {
          msg ("The guard has left his post, apparently to alert his superiors about something.")
        }
        else {
          msg ("A stoic guard in a crisp uniform stands near the velvet rope, watching the restricted painting closely. He does not look like someone easily fooled.")
        }
      </look>
      <speak type="script"><![CDATA[
        if (this.isDistracted) {
          msg ("The guard is not here.")
        }
        else {
          msg ("Gallery Guard: \"No touching the artwork, signore. And stay behind the rope.\"<br/><br/>He stares at you coldly, clearly not interested in conversation.")
        }
      ]]></speak>
    </object>
    <object name="Portrait of Giuseppe">
      <inherit name="editor_object" />
      <look>A massive, ostentatious self-portrait of Guido Giuseppe. He is depicted in regal attire, looking down at the viewer with smug satisfaction. The frame is solid gold and encrusted with gems. Gaudy beyond belief.</look>
    </object>
    <object name="Landscape Painting">
      <inherit name="editor_object" />
      <alias>Venetian Sunset</alias>
      <look>A beautiful landscape painting titled "Venetian Sunset." The colors are masterful, capturing the golden light reflecting off the canals. It is signed by a famous Venetian artist.</look>
    </object>
    <object name="Restricted Painting">
      <inherit name="editor_object" />
      <alias>The Last Venetian Duke</alias>
      <hasBeenExamined type="boolean">false</hasBeenExamined>
      <look type="script"><![CDATA[
        if (Gallery Guard.isDistracted) {
          if (this.hasBeenExamined) {
            msg ("The painting of the Last Venetian Duke. Behind the frame you found a hidden compartment containing your family's signet ring and a faded letter.")
          }
          else {
            msg ("With the guard gone, you step over the velvet rope and examine the painting closely.<br/><br/>Something about it seems hauntingly familiar... The face of the duke, his posture, the coat of arms in the corner - it bears the Forger family crest!<br/><br/>This painting was stolen from your family during their downfall. Looking closer, you notice the brushwork is uneven in places, as if concealing something beneath.")
          }
        }
        else {
          msg ("A stunning portrait of a Venetian Duke in ceremonial robes, displayed behind a velvet rope in the restricted area. The guard watches it closely.<br/><br/>Something about the painting seems strangely familiar to you...")
        }
      ]]></look>
      <rewrite type="script"><![CDATA[
        if (Gallery Guard.isDistracted) {
          if (this.hasBeenExamined) {
            msg ("You have already revealed the hidden message.")
          }
          else {
            msg ("You use the Shkruesiverita on the painting, focusing on the areas where the brushwork seems uneven...<br/><br/>The magic of the pencil reveals text hidden beneath layers of paint:<br/><br/>\"To my heir: Trust in the family motto. The truth lies beneath the lies. - Grandfather Forger\"<br/><br/>Moved by this message from your grandfather, you examine the frame more carefully and discover a hidden compartment behind it.<br/><br/>Inside you find a Forger Family Signet Ring and a faded letter.")
            this.hasBeenExamined = true
            AddToInventory (Forger Family Signet Ring)
            AddToInventory (Faded Letter)
          }
        }
        else {
          msg ("You cannot get close enough to the painting with the guard watching. You need to find a way to distract him first.")
        }
      ]]></rewrite>
    </object>
    <object name="Bronze Sculpture">
      <inherit name="editor_object" />
      <alias>Sculpture of Mercury</alias>
      <look>A bronze sculpture of Mercury, the messenger god, caught mid-flight with winged sandals. Despite Giuseppe's questionable taste, this piece is genuinely impressive.</look>
    </object>
    <object name="Guest Book">
      <inherit name="editor_object" />
      <isAltered type="boolean">false</isAltered>
      <look type="script"><![CDATA[
        if (this.isAltered) {
          msg ("The guest book now shows an entry for an Inspector from the Ministry of Cultural Affairs conducting a surprise audit. The guard panicked when he saw it and left to alert his superiors.")
        }
        else {
          msg ("A leather-bound guest book where notable visitors sign their names. You see signatures from various nobles, artists, and dignitaries who have viewed the collection.<br/><br/>The book sits on a small podium near the entrance.")
        }
      ]]></look>
      <rewrite type="script"><![CDATA[
        if (this.isAltered) {
          msg ("You have already altered the guest book.")
        }
        else {
          msg ("You use the Shkruesiverita to add a new entry to the guest book:<br/><br/>\"Inspector Marcello Ricci - Ministry of Cultural Affairs - Conducting Surprise Audit\"<br/><br/>You step back and wait. The guard glances at the book out of habit and his face goes pale.<br/><br/>Gallery Guard: \"An inspector? Here? Now? I must inform Signor Giuseppe immediately!\"<br/><br/>He rushes out of the gallery. The art critic, delighted by the chaos, hurries off to examine other paintings she couldn't access before.<br/><br/>The restricted area is now unguarded.")
          this.isAltered = true
          Gallery Guard.isDistracted = true
        }
      ]]></rewrite>
    </object>
    <object name="Velvet Rope">
      <inherit name="editor_object" />
      <look type="script">
        if (Gallery Guard.isDistracted) {
          msg ("The velvet rope that once blocked access to the restricted area. With the guard gone, nothing stops you from stepping over it.")
        }
        else {
          msg ("A velvet rope on brass stands separates visitors from the most valuable painting in the collection. The guard watches it closely.")
        }
      </look>
    </object>
    <object name="Forger Family Signet Ring">
      <inherit name="editor_object" />
      <visible type="boolean">false</visible>
      <look>Your family's signet ring, bearing the Forger crest. It was lost when your family fell from grace. Having it back feels like reclaiming a piece of your identity.</look>
      <drop type="boolean">false</drop>
      <inventoryverbs type="stringlist">
        <value>Look at</value>
      </inventoryverbs>
    </object>
    <object name="Faded Letter">
      <inherit name="editor_object" />
      <visible type="boolean">false</visible>
      <look><![CDATA[A faded letter from your grandfather, hidden behind the painting for decades. It reads:<br/><br/>"My dear heir, if you are reading this, then our family has fallen on dark times. Know that Giuseppe's vault holds more than documents - it holds our legacy. The vault can be heard through the walls of the wine cellar. Listen, and you may learn its secrets. Trust no one but family. - Your loving Grandfather"]]></look>
      <drop type="boolean">false</drop>
      <inventoryverbs type="stringlist">
        <value>Look at</value>
      </inventoryverbs>
    </object>
  </object>
  <object name="Coat Room">
    <inherit name="editor_room" />
    <description>Next to the entrance to the ballroom there is a coatroom. Many of the guest's lavish and expensive clothing items are kept here.</description>
    <exit alias="northeast" to="Main Ballroom">
      <inherit name="northeastdirection" />
    </exit>
    <object name="Attendant">
      <inherit name="editor_object" />
      <inherit name="female" />
      <look>You see an attendant at the coat check-in. She appears to be young and inexperienced. Maybe you can take advantage of her inexperience...</look>
      <speak type="script"><![CDATA[
        msg ("You walk up to the attendant at the coat check-in.")
        topics = Split ("How is it going;I would like to get my coat back;I would like to check my coat in", ";")
        ShowMenu ("What would you like to say?", topics, false) {
          switch (result) {
            case ("How is it going") {
              msg ("Attendant: \"Fine, I suppose. There are so many guests here, I am a bit overwhelmed. I would not be able to keep track of all of them. I am not very good at remembering people's names or faces. It is a good thing we have these tickets to keep track of the guest's items.\"")
            }
            case ("I would like to get my coat back") {
              if (player.hasCoatTicket) {
                if (Coat Ticket.altered) {
                  msg ("With the altered ticket you wait a while to make sure the attendant does not remember your face...<br/><br/>After some time you approach the desk and ask for 'your' coat back...<br/><br/>Attendant: \"May I have your ticket Signore?\"<br/><br/>You hand over the altered ticket.<br/><br/>Attendant: \"I will be right back with your Coat\"<br/><br/>She goes to check on the various coats in the back...<br/><br/>Attendant: \"Here you go Signore Romano\"<br/><br/>She hands over the coat.<br/><br/>You take the coat and the key to the dungeon out of the pocket.")
                  AddToInventory (Guard Coat)
                  AddToInventory (Key to Dungeon Prisoner)
                }
                else {
                  msg ("You currently only have the ticket for your own coat. You have no need for it back. Another person's coat might be more helpful for your objective...")
                }
              }
              else {
                msg ("Attendant: \"May I have your ticket Signore?\"<br/><br/>You sheepishly explain that you do not have a ticket. You make an excuse that you must have misplaced it.<br/><br/>(Threat level increased)")
                game.threat = game.threat + 1
              }
            }
            case ("I would like to check my coat in") {
              if (player.hasOwnCoat) {
                msg ("You hand over you coat to the Attendant<br/><br/>Attendant: \"Thank you Signore. What is your name to retrieve your coat?\"<br/><br/>You respond saying \"Dinak Forger\"<br/><br/>Attendant: \"Here is your ticket to retrieve your coat whenever you would like\"<br/><br/>She hands over the Coat Ticket")
                AddToInventory (Coat Ticket)
                set (player, "hasCoatTicket", true)
                RemoveObject (Coat)
                set (player, "hasOwnCoat", false)
              }
              else {
                msg ("You don't have a coat you would like to hand over.")
              }
            }
          }
        }
      ]]></speak>
      <object name="Coat Ticket">
        <inherit name="editor_object" />
        <look>A ticket to retireve a coat from the coat-room.</look>
        <scenery type="boolean">false</scenery>
        <visible />
        <altered type="boolean">false</altered>
        <drop type="boolean">false</drop>
        <inventoryverbs type="stringlist">
          <value>Look at</value>
          <value>Use</value>
        </inventoryverbs>
        <listalias>Coat Ticket</listalias>
        <take />
        <feature_usegive />
        <useon type="scriptdictionary">
          <item key="Shkruesiverita">
            if (player.knowsCoatGuardName) {
              msg ("You alter the text of the Coat Ticket to show 'Marco Romano'")
              set (Coat Ticket, "altered", true)
            }
            else {
              msg ("You don't know what to change the text to")
            }
          </item>
        </useon>
      </object>
      <object name="Key to Dungeon Prisoner">
        <inherit name="editor_object" />
        <visible />
        <look>The key to the Dungeon Prisoner's Cell.</look>
        <inventoryverbs type="stringlist">
          <value>Look at</value>
          <value>Use</value>
        </inventoryverbs>
        <feature_usegive />
        <drop type="boolean">false</drop>
        <use />
        <selfuseon type="scriptdictionary">
          <item key="Dungeon Prisoner"><![CDATA[
            msg ("You use the Dungeon Key to free the man.<br/><br/>Dungeon Prisoner: \"Thank you. I was starting to think I was going to be in there for a long, long time. I will keep my promise, the last digit for the vault combination is 3. I need to get out of here though. Let me take that Guard Coat so I can sneak out of here\"<br/><br/>You reluctantly give the coat over.<br/><br/>He quickly puts on the coat.<br/><br/>Dungeon Prisoner: \"Goodbye, I hope you can get into that vault to make Guido Giuseppe mad\"<br/><br/>He hurries off...")
            RemoveObject (Guard Coat)
            RemoveObject (Dungeon Prisoner)
            set (player, "knowsVaultLastDigit", true)
          ]]></item>
        </selfuseon>
      </object>
      <object name="Guard Coat">
        <inherit name="editor_object" />
        <look>The coat of the guard who locked up the prisoner in the Dungeon.</look>
        <visible />
        <drop type="boolean">false</drop>
        <inventoryverbs type="stringlist">
          <value>Look at</value>
          <value>Use</value>
        </inventoryverbs>
      </object>
    </object>
  </object>
  <object name="Music Salon">
    <inherit name="editor_room" />
    <exit alias="southeast" to="Main Ballroom">
      <inherit name="southeastdirection" />
    </exit>
  </object>
  <object name="Kitchen">
    <inherit name="editor_room" />
    <description><![CDATA[A bustling kitchen filled with the aromas of Italian cuisine. Cooks and servants hurry about preparing elaborate dishes for the party. Pots bubble on stoves, and the clatter of dishes fills the air.<br/><br/>A {object:Head Chef} commands the chaos with theatrical gestures. A nervous {object:Young Servant} hovers near the door leading down to the basement.]]></description>
    <exit alias="southwest" to="Main Ballroom">
      <inherit name="southwestdirection" />
    </exit>
    <exit alias="down" to="Basement Entrance">
      <inherit name="downdirection" />
    </exit>
    <object name="Head Chef">
      <inherit name="editor_object" />
      <inherit name="male" />
      <alias>Head Chef Marco</alias>
      <hasReceivedSaffron type="boolean">false</hasReceivedSaffron>
      <look>A rotund man with a thick mustache and a tall chef's hat. He barks orders at the kitchen staff while frantically stirring multiple pots. Sweat beads on his forehead.</look>
      <speak type="script"><![CDATA[
        if (this.hasReceivedSaffron) {
          msg ("Head Chef Marco: \"Ah, my friend! The saffron risotto was a triumph! If you need anything, just ask!\"")
        }
        else {
          msg ("The chef barely acknowledges you, waving a ladle dismissively.")
          topics = Split ("How is the cooking going;Can I help with anything;I need to get to the basement", ";")
          ShowMenu ("What would you like to say?", topics, false) {
            switch (result) {
              case ("How is the cooking going") {
                msg ("Head Chef Marco: \"Terrible! Magnifico! All at once!\" He gestures wildly. \"We are missing saffron for the risotto! The VIP table will have my head! But I cannot leave my station!\"")
              }
              case ("Can I help with anything") {
                msg ("Head Chef Marco: \"Unless you have saffron from the Rialto market hiding in your pocket, no!\" He returns to his frantic cooking.")
              }
              case ("I need to get to the basement") {
                msg ("Head Chef Marco: \"Guests do not belong in the basement! Now leave my kitchen before you ruin something!\"<br/><br/>(Threat level increased)")
                game.threat = game.threat + 1
              }
            }
          }
        }
      ]]></speak>
    </object>
    <object name="Young Servant">
      <inherit name="editor_object" />
      <inherit name="female" />
      <alias>Lucia</alias>
      <isFreed type="boolean">false</isFreed>
      <hasBeenAskedAboutDebt type="boolean">false</hasBeenAskedAboutDebt>
      <look type="script">
        if (this.isFreed) {
          msg ("Lucia stands near the basement door with a relieved smile. She nods at you gratefully whenever you pass.")
        }
        else {
          msg ("A young woman in a servant's uniform, perhaps in her early twenties. She stands nervously near the basement door, fidgeting with her apron. Her eyes dart around as if expecting trouble.")
        }
      </look>
      <speak type="script"><![CDATA[
        if (this.isFreed) {
          msg ("Lucia: \"I cannot thank you enough, signore. If there is anything else you need to know, just ask.\"")
          topics = Split ("Tell me about the basement;What do you know about the vault;Any other secrets", ";")
          ShowMenu ("What would you like to ask?", topics, false) {
            switch (result) {
              case ("Tell me about the basement") {
                msg ("Lucia: \"The basement has the wine cellar, and beyond that... darker places. There is a dungeon where Signor Giuseppe keeps those who displease him.\"")
              }
              case ("What do you know about the vault") {
                msg ("Lucia: \"The vault is past the wine cellar, heavily guarded. But there is a prisoner in the dungeon - Antonio, I think - who knows something about the combination. He was Giuseppe's former business partner.\"")
              }
              case ("Any other secrets") {
                msg ("Lucia: \"The guards change shifts when the church bells ring at midnight. That might be useful if you need to move unseen.\"")
              }
            }
          }
        }
        else {
          msg ("The servant looks at you nervously.")
          topics = Split ("Can I pass through here;Why do you look so worried;Why do you work here", ";")
          ShowMenu ("What would you like to say?", topics, false) {
            switch (result) {
              case ("Can I pass through here") {
                msg ("Lucia: \"I am sorry, signore, but guests are not allowed in the basement. The master's orders.\"<br/><br/>She looks genuinely apologetic but will not move.")
              }
              case ("Why do you look so worried") {
                msg ("Lucia: \"It is nothing, signore. Just... the party makes everyone nervous.\"<br/><br/>She does not seem to want to share more without a reason to trust you.")
              }
              case ("Why do you work here") {
                msg ("Lucia sighs heavily.<br/><br/>Lucia: \"I owe Signor Giuseppe money. A debt my father left behind when he died. I must work it off, but the interest keeps growing. I fear I will never be free of this place.\"<br/><br/>She looks at the floor.<br/><br/>Lucia: \"The Servant's Ledger in the pantry tracks all our debts. Mine shows 500 Lira, but I have already paid back twice that amount. It is hopeless.\"")
                this.hasBeenAskedAboutDebt = true
              }
            }
          }
        }
      ]]></speak>
    </object>
    <object name="Pantry">
      <inherit name="editor_object" />
      <look>A large pantry filled with ingredients, spices, and cooking supplies. Various jars line the shelves, and a ledger book sits on a small desk.</look>
      <displayverbs type="stringlist">
        <value>Look at</value>
        <value>Search</value>
      </displayverbs>
      <search type="script"><![CDATA[
        msg ("You search through the pantry carefully.<br/><br/>Among the various ingredients, you find:")
        msg ("- A jar labeled 'Turmeric'")
        msg ("- Various spices and cooking supplies")
        msg ("- A thick ledger book titled 'Servant's Ledger'")
        MakeObjectVisible (Turmeric Jar)
        MakeObjectVisible (Servant's Ledger)
      ]]></search>
    </object>
    <object name="Turmeric Jar">
      <inherit name="editor_object" />
      <visible type="boolean">false</visible>
      <alias>Jar of Turmeric</alias>
      <isAltered type="boolean">false</isAltered>
      <look type="script">
        if (this.isAltered) {
          msg ("The jar now reads 'Saffron' thanks to the Shkruesiverita. The Head Chef would be very grateful for this.")
        }
        else {
          msg ("A glass jar containing bright yellow turmeric powder. The label clearly reads 'Turmeric'. It looks somewhat similar to saffron...")
        }
      </look>
      <take />
      <drop type="boolean">false</drop>
      <inventoryverbs type="stringlist">
        <value>Look at</value>
        <value>Use</value>
        <value>Give</value>
      </inventoryverbs>
      <feature_usegive />
      <giveto type="scriptdictionary">
        <item key="Head Chef"><![CDATA[
          if (Turmeric Jar.isAltered) {
            msg ("You present the jar to the Head Chef.<br/><br/>Head Chef Marco: \"Saffron! You found saffron! You are a miracle worker, my friend!\"<br/><br/>He snatches the jar and immediately begins adding it to the risotto.<br/><br/>Head Chef Marco: \"The VIP table will have their risotto! And you - you deserve a reward. Come, I will take you to the wine cellar myself to select the finest bottle!\"<br/><br/>He escorts you toward the basement entrance, waving off any objections from the servants.<br/><br/>Head Chef Marco: \"Let this guest through! He is with me!\"<br/><br/>Lucia steps aside, looking surprised but relieved.")
            Head Chef.hasReceivedSaffron = true
            Young Servant.isFreed = true
            RemoveObject (Turmeric Jar)
          }
          else {
            msg ("Head Chef Marco: \"Turmeric? TURMERIC?! I asked for saffron, not this yellow powder!\" He waves you away angrily.")
          }
        ]]></item>
      </giveto>
      <rewrite type="script"><![CDATA[
        if (this.isAltered) {
          msg ("You have already changed the label.")
        }
        else {
          msg ("You use the Shkruesiverita to carefully alter the label from 'Turmeric' to 'Saffron'. The powder inside looks convincing enough...")
          this.isAltered = true
        }
      ]]></rewrite>
    </object>
    <object name="Servant's Ledger">
      <inherit name="editor_object" />
      <visible type="boolean">false</visible>
      <isAltered type="boolean">false</isAltered>
      <look type="script"><![CDATA[
        if (this.isAltered) {
          msg ("The ledger now shows Lucia's debt as 'PAID IN FULL'. She must be overjoyed.")
        }
        else {
          msg ("A thick ledger book tracking the debts of all servants in the household. Flipping through, you find many names with crushing amounts owed.<br/><br/>One entry catches your eye:<br/><br/>\"Lucia Benedetti - Owes: 500 Lira - Interest accruing\"<br/><br/>The poor woman was telling the truth. Giuseppe keeps his servants trapped through debt.")
        }
      ]]></look>
      <take />
      <drop type="boolean">false</drop>
      <inventoryverbs type="stringlist">
        <value>Look at</value>
        <value>Use</value>
        <value>Show</value>
      </inventoryverbs>
      <feature_usegive />
      <rewrite type="script"><![CDATA[
        if (this.isAltered) {
          msg ("You have already altered Lucia's entry.")
        }
        else {
          msg ("You use the Shkruesiverita to alter Lucia's entry:<br/><br/>From: \"Lucia Benedetti - Owes: 500 Lira - Interest accruing\"<br/>To: \"Lucia Benedetti - Owes: 0 Lira - PAID IN FULL\"<br/><br/>The ink shimmers and settles into place. As far as this ledger is concerned, Lucia is free.")
          this.isAltered = true
        }
      ]]></rewrite>
      <giveto type="scriptdictionary">
        <item key="Young Servant"><![CDATA[
          if (Servant's Ledger.isAltered) {
            msg ("You show Lucia the altered ledger. Her eyes go wide as she reads her entry.<br/><br/>Lucia: \"Paid in full? But... but how?\"<br/><br/>Tears well up in her eyes.<br/><br/>Lucia: \"I do not understand, but... I am free? Truly free?\"<br/><br/>She clutches the ledger to her chest, then looks at you with overwhelming gratitude.<br/><br/>Lucia: \"Signore, I do not know how you did this, but I am forever in your debt - no, not debt, never that word again - in your gratitude. Please, let me help you. The basement is yours to explore.\"<br/><br/>She steps aside from the basement door.")
            Young Servant.isFreed = true
          }
          else {
            msg ("Lucia glances at the ledger and her face falls.<br/><br/>Lucia: \"Yes, there it is. My debt. 500 Lira that I will never pay off. Why show me this, signore? To mock me?\"<br/><br/>She looks hurt.")
          }
        ]]></item>
      </giveto>
    </object>
    <object name="Service Menu">
      <inherit name="editor_object" />
      <look>A detailed menu showing all the dishes being prepared for the party and their delivery schedule. One entry is circled in red: "Saffron Risotto - VIP Table - 9:00 PM - URGENT: Missing saffron"</look>
    </object>
    <object name="Wine Crates">
      <inherit name="editor_object" />
      <look>Wooden crates filled with wine bottles, waiting to be taken down to the cellar. The labels show they are expensive Venetian vintages.</look>
    </object>
  </object>
  <object name="Ballroom Second Floor">
    <inherit name="editor_room" />
    <isHostile />
    <description>The Giusseppe estate has a second floor to it with another ballroom. It's expensive decorations line the walls, ceiling, and floor. The upstairs ballroom is crowded with people, with many touring the various bedrooms.</description>
    <enter type="script"><![CDATA[
      if (Got(Shining Key) and this.isHostile) {
        msg ("As you walk into the ballroom, people begin to take notice to the bright light emitted from your pocket. One of the guests approaches you.")
        topics = Split ("I have a bomb;I ate the Sun;It's my magic watch;Stay silent", ";")
        ShowMenu ("\"What is that in your pocket good sir?\"", topics, false) {
          switch (result) {
            case ("I have a bomb") {
              msg ("You now have guards chasing after you. You have 2 actions before they grab you.")
              game.threat = 10
            }
            case ("I ate the Sun") {
              msg ("\"... Okay.\"")
              game.threat = game.threat + 3
              if (game.threat >= 10) {
                msg ("You now have guards chasing after you. You have 2 actions before they grab you.")
              }
            }
            case ("It's my magic watch") {
              msg ("\"Oh okay then.\"")
              game.threat = game.threat + 1
              if (game.threat >= 10) {
                msg ("You now have guards chasing after you. You have 2 actions before they grab you.")
              }
            }
            case ("Stay silent") {
              msg ("\"...\"")
              game.threat = game.threat + 3
              if (game.threat >= 10) {
                msg ("You now have guards chasing after you. You have 2 actions before they grab you.")
              }
            }
          }
        }
        this.isHostile = false
      }
    ]]></enter>
    <exit alias="down" to="Main Ballroom">
      <inherit name="downdirection" />
    </exit>
    <exit alias="northwest" to="Bedchamber 1">
      <inherit name="northwestdirection" />
    </exit>
    <exit alias="west" to="Study">
      <inherit name="westdirection" />
    </exit>
    <exit alias="southwest" to="Bathroom">
      <inherit name="southwestdirection" />
    </exit>
    <exit name="Master Bedroom Ballroom Entrance" alias="south" to="Master Bedroom">
      <inherit name="southdirection" />
      <locked type="boolean">false</locked>
      <runscript />
      <isOpened type="boolean">false</isOpened>
      <script type="script">
        if (Got(Shining Key) or this.isOpened) {
          msg ("As you open the door, the people around you realize that you are an intruder")
          game.threat = 10
          this.isOpened = true
          RemoveObject (Shining Key)
          MovePlayer (Master Bedroom)
        }
        else {
          msg ("The door is locked")
        }
      </script>
    </exit>
    <exit alias="southeast" to="Lounge">
      <inherit name="southeastdirection" />
    </exit>
    <exit alias="east" to="Bedchamber 3">
      <inherit name="eastdirection" />
    </exit>
    <exit alias="northeast" to="Bedchamber 2">
      <inherit name="northeastdirection" />
    </exit>
  </object>
  <object name="Bedchamber 1">
    <inherit name="editor_room" />
    <description><![CDATA[A luxurious guest bedchamber adorned with Venetian silk curtains and gilded furniture. The room belongs to {object:Countess Valentina}, a prominent guest at the party.<br/><br/>Her {object:Vanity Table} is cluttered with perfume bottles. A {object:Traveling Trunk} sits at the foot of the ornate bed, and an elegant {object:Writing Desk} holds scattered papers.]]></description>
    <exit alias="southeast" to="Ballroom Second Floor">
      <inherit name="southeastdirection" />
    </exit>
    <object name="Countess Valentina">
      <inherit name="editor_object" />
      <inherit name="female" />
      <alias>Countess Valentina Morosini</alias>
      <isDistracted type="boolean">false</isDistracted>
      <look type="script">
        if (this.isDistracted) {
          msg ("The Countess has left for her portrait sitting in the Gallery.")
        }
        else {
          msg ("A sharp-tongued noblewoman in her 50s, dressed in elegant black silk. Despite attending the party, she carries an air of disdain for everything around her. She guards her belongings jealously, particularly the traveling trunk.")
        }
      </look>
      <speak type="script"><![CDATA[
        if (this.isDistracted) {
          msg ("The Countess is not here.")
        }
        else {
          msg ("The Countess regards you with cool suspicion.")
          topics = Split ("What brings you to the party;You seem to dislike the host;What is in that trunk", ";")
          ShowMenu ("What would you like to say?", topics, false) {
            switch (result) {
              case ("What brings you to the party") {
                msg ("Countess Valentina: \"Social obligation, nothing more. When Guido Giuseppe extends an invitation, one does not refuse - unless one wishes to become his enemy.\"<br/><br/>She sighs with barely concealed contempt.")
              }
              case ("You seem to dislike the host") {
                msg ("Countess Valentina: \"Guido Giuseppe is a snake who has ruined many good families. I keep evidence of his dealings in my trunk - insurance, you might call it. But I would never share such things with a stranger.\"<br/><br/>She eyes you carefully.")
              }
              case ("What is in that trunk") {
                msg ("Countess Valentina: \"My personal effects, locked away safely. The combination is my late husband Enrico's birthday - a date I keep close to my heart.\"<br/><br/>Her expression softens momentarily.<br/><br/>Countess Valentina: \"He passed ten years ago. I still miss him every day.\"")
              }
            }
          }
        }
      ]]></speak>
    </object>
    <object name="Vanity Table">
      <inherit name="editor_object" />
      <look>An ornate vanity table covered with expensive perfume bottles, cosmetics, and a {object:Hand Mirror}. The Countess clearly travels in style.</look>
    </object>
    <object name="Hand Mirror">
      <inherit name="editor_object" />
      <look><![CDATA[An exquisite silver hand mirror with intricate engravings. On the back, you notice an inscription:<br/><br/>"To my beloved Valentina, on our wedding day - Your Enrico, March 7th, 1919"<br/><br/>A touching memento of the Countess's late husband.]]></look>
    </object>
    <object name="Writing Desk">
      <inherit name="editor_object" />
      <look type="script"><![CDATA[
        if (Countess Valentina.isDistracted) {
          msg ("With the Countess gone, you search the desk more thoroughly. Among the papers you find:<br/><br/>- Various correspondence<br/>- A personal diary<br/>- A party schedule")
          MakeObjectVisible (Countess Diary)
          MakeObjectVisible (Party Schedule)
        }
        else {
          msg ("An elegant writing desk with scattered papers and correspondence. The Countess watches you carefully if you approach it too closely.")
        }
      ]]></look>
    </object>
    <object name="Countess Diary">
      <inherit name="editor_object" />
      <visible type="boolean">false</visible>
      <alias>Personal Diary</alias>
      <look><![CDATA[A leather-bound diary with the Countess's personal thoughts. Flipping through, one entry catches your eye:<br/><br/>"April 12th, 1939 - Today marks 50 years since my dear Enrico was born. I visited his grave and left flowers. I still remember the day we met, when he was just a young man of 20..."<br/><br/>So Enrico's birthday was April 12th - the trunk combination must be 412.]]></look>
      <take />
      <drop type="boolean">false</drop>
      <inventoryverbs type="stringlist">
        <value>Look at</value>
      </inventoryverbs>
    </object>
    <object name="Party Schedule">
      <inherit name="editor_object" />
      <visible type="boolean">false</visible>
      <isAltered type="boolean">false</isAltered>
      <look type="script"><![CDATA[
        if (this.isAltered) {
          msg ("The schedule now shows the Countess's portrait sitting is happening RIGHT NOW. She left in a hurry.")
        }
        else {
          msg ("A schedule of events for the party. One entry is relevant:<br/><br/>\"Countess Valentina Morosini - Portrait Sitting in Gallery - 11:00 PM\"<br/><br/>That is still a while away. If only the time could be changed...")
        }
      ]]></look>
      <take />
      <drop type="boolean">false</drop>
      <inventoryverbs type="stringlist">
        <value>Look at</value>
        <value>Use</value>
      </inventoryverbs>
      <rewrite type="script"><![CDATA[
        if (this.isAltered) {
          msg ("You have already altered the schedule.")
        }
        else {
          msg ("You use the Shkruesiverita to change the time of the portrait sitting from '11:00 PM' to 'NOW - IMMEDIATELY'.<br/><br/>A servant appears at the door moments later.<br/><br/>Servant: \"Countess Morosini? The artist is ready for your portrait sitting in the Gallery.\"<br/><br/>Countess Valentina: \"What? Already? The schedule said 11:00!\"<br/><br/>Servant: \"I apologize, signora, but the schedule clearly says immediately. The artist is waiting.\"<br/><br/>The Countess huffs indignantly but leaves the room, muttering about incompetent staff.<br/><br/>You are now alone in the bedchamber.")
          this.isAltered = true
          Countess Valentina.isDistracted = true
        }
      ]]></rewrite>
    </object>
    <object name="Traveling Trunk">
      <inherit name="editor_object" />
      <isOpen type="boolean">false</isOpen>
      <look type="script">
        if (this.isOpen) {
          msg ("The trunk lies open. Inside you found various documents and a torn piece of paper with a vault digit.")
        }
        else if (Countess Valentina.isDistracted) {
          msg ("A sturdy traveling trunk with a small combination lock. Three dials show numbers 0-9. Now that the Countess is gone, you could try to open it.")
        }
        else {
          msg ("A sturdy traveling trunk at the foot of the bed, secured with a small combination lock. The Countess watches it protectively.")
        }
      </look>
      <displayverbs type="stringlist">
        <value>Look at</value>
        <value>Open</value>
      </displayverbs>
      <open type="script"><![CDATA[
        if (this.isOpen) {
          msg ("The trunk is already open.")
        }
        else if (not Countess Valentina.isDistracted) {
          msg ("The Countess glares at you.<br/><br/>Countess Valentina: \"Do not touch my belongings!\"<br/><br/>(Threat level increased)")
          game.threat = game.threat + 2
        }
        else {
          msg ("You examine the combination lock. Three dials, each showing 0-9.")
          topics = Split ("123;412;719;307", ";")
          ShowMenu ("Enter a combination:", topics, false) {
            switch (result) {
              case ("412") {
                msg ("You enter 4-1-2 - April 12th, Enrico's birthday.<br/><br/>Click!<br/><br/>The lock springs open. Inside the trunk you find expensive clothing, jewelry, and a stack of documents. Among them is a torn piece of paper that seems out of place.<br/><br/>The paper reads: \"Second: 7\"<br/><br/>This must be part of a vault combination! The Countess must have stolen this from Giuseppe's study.")
                this.isOpen = true
                set (player, "knowsVaultSecondDigit", true)
              }
              case ("123") {
                msg ("The lock does not budge. That combination is incorrect.")
              }
              case ("719") {
                msg ("The lock does not budge. That combination is incorrect.")
              }
              case ("307") {
                msg ("The lock does not budge. That combination is incorrect - though March 7th was their wedding day, not his birthday.")
              }
            }
          }
        }
      ]]></open>
    </object>
  </object>
  <object name="Bedchamber 2">
    <inherit name="editor_room" />
    <description><![CDATA[A stately guest chamber with a distinctly Austrian aesthetic. This room has been assigned to {object:Baron Friedrich}, an Austrian diplomat.<br/><br/>A {object:Chess Set} sits mid-game on a side table. {object:Diplomatic Papers} are spread on a desk, and a {object:Painting of the Alps} hangs slightly askew on the wall. A {object:Guest Registry Card} lies on the nightstand.]]></description>
    <exit alias="southwest" to="Ballroom Second Floor">
      <inherit name="southwestdirection" />
    </exit>
    <object name="Baron Friedrich">
      <inherit name="editor_object" />
      <inherit name="male" />
      <alias>Baron Friedrich von Stein</alias>
      <isDistracted type="boolean">false</isDistracted>
      <hasBeenImpressed type="boolean">false</hasBeenImpressed>
      <look type="script">
        if (this.isDistracted) {
          msg ("The Baron has left to find his 'correct' room after the registry confusion.")
        }
        else {
          msg ("A calculating man in his 50s with sharp eyes and a perfectly groomed mustache. He wears an Austrian military uniform with numerous medals. He studies you like a chess opponent.")
        }
      </look>
      <speak type="script"><![CDATA[
        if (this.isDistracted) {
          msg ("The Baron is not here.")
        }
        else if (this.hasBeenImpressed) {
          msg ("Baron Friedrich: \"Ah, my clever friend. Is there something else you wish to discuss?\"")
          topics = Split ("Tell me about Giuseppe;What secrets do you know;That is all for now", ";")
          ShowMenu ("What would you like to ask?", topics, false) {
            switch (result) {
              case ("Tell me about Giuseppe") {
                msg ("Baron Friedrich: \"Giuseppe is a useful fool. He thinks he controls Italian politics, but he is merely a pawn in larger games. Austria watches him closely.\"")
              }
              case ("What secrets do you know") {
                msg ("Baron Friedrich leans in conspiratorially.<br/><br/>Baron Friedrich: \"I have observed the guard rotations in this estate. They change shifts on the hour. During the transition, the basement is less watched. If one were planning something... illicit... that would be the time.\"")
              }
              case ("That is all for now") {
                msg ("The Baron nods and returns to studying his chess position.")
              }
            }
          }
        }
        else {
          msg ("The Baron regards you with cool interest.")
          msg ("Baron Friedrich: \"Ah, another guest. Tell me, in this game of shadows we all play at such parties...\"")
          topics = Split ("I am a pawn;I am a knight;I am a king", ";")
          ShowMenu ("\"...what piece are you?\"", topics, false) {
            switch (result) {
              case ("I am a pawn") {
                msg ("Baron Friedrich snorts dismissively.<br/><br/>Baron Friedrich: \"A pawn? Pawns do not attend parties like this. They serve the drinks. You waste my time.\"<br/><br/>(Threat level increased)")
                game.threat = game.threat + 1
              }
              case ("I am a knight") {
                msg ("Baron Friedrich raises an eyebrow, intrigued.<br/><br/>Baron Friedrich: \"A knight? Interesting choice. The knight moves in unexpected ways, strikes from angles others cannot see. Perhaps you have some cleverness in you.\"<br/><br/>He gestures to the chess board.<br/><br/>Baron Friedrich: \"Prove it. Examine my game and tell me the winning move.\"")
              }
              case ("I am a king") {
                msg ("Baron Friedrich laughs coldly.<br/><br/>Baron Friedrich: \"A king? Kings do not sneak into parties uninvited. And I can always tell who belongs and who does not.\"<br/><br/>He eyes you suspiciously.")
              }
            }
          }
        }
      ]]></speak>
    </object>
    <object name="Chess Set">
      <inherit name="editor_object" />
      <look type="script"><![CDATA[
        if (Baron Friedrich.isDistracted) {
          msg ("The chess set remains in its mid-game position. The Baron left before finishing his analysis.")
        }
        else if (Baron Friedrich.hasBeenImpressed) {
          msg ("The chess set shows the winning position you identified. The Baron was impressed by your insight.")
        }
        else {
          msg ("An elegant chess set showing a complex mid-game position. White pieces (the Baron's side) appear to be in a strong position. Studying the board, you notice the white knight could deliver checkmate in two moves by moving to G7.<br/><br/>The Baron watches to see if you understand.")
          topics = Split ("Knight to G7;Queen takes bishop;Castle kingside", ";")
          ShowMenu ("What is the winning move?", topics, false) {
            switch (result) {
              case ("Knight to G7") {
                msg ("Baron Friedrich: \"Knight to G7! Exactly correct. Checkmate in two moves.\"<br/><br/>He stands and offers his hand.<br/><br/>Baron Friedrich: \"You have a strategist's mind. I respect that. Perhaps we can help each other.\"<br/><br/>He leans closer.<br/><br/>Baron Friedrich: \"Giuseppe hides his secrets behind beautiful facades. Check behind the painting of my homeland - you may find something useful.\"")
                Baron Friedrich.hasBeenImpressed = true
              }
              case ("Queen takes bishop") {
                msg ("Baron Friedrich shakes his head.<br/><br/>Baron Friedrich: \"A crude move. The queen would be exposed. Think more carefully.\"")
              }
              case ("Castle kingside") {
                msg ("Baron Friedrich laughs.<br/><br/>Baron Friedrich: \"Castle? In the middle of an attack? You disappoint me.\"")
              }
            }
          }
        }
      ]]></look>
    </object>
    <object name="Diplomatic Papers">
      <inherit name="editor_object" />
      <look>Stacks of diplomatic correspondence in German and Italian. Most appear to be coded messages and official communications. You cannot make sense of them without more context.</look>
    </object>
    <object name="Painting of the Alps">
      <inherit name="editor_object" />
      <alias>Painting of the Austrian Alps</alias>
      <hasBeenSearched type="boolean">false</hasBeenSearched>
      <look type="script"><![CDATA[
        if (this.hasBeenSearched) {
          msg ("The painting of the Austrian Alps hangs properly now. You already found the hidden document behind it.")
        }
        else if (Baron Friedrich.hasBeenImpressed or Baron Friedrich.isDistracted) {
          msg ("A beautiful painting of the Austrian Alps, hanging slightly askew. Following the Baron's hint (or taking advantage of his absence), you look behind it.<br/><br/>Hidden in a small pouch attached to the frame, you find a document: a detailed schedule of guard rotations in the Giuseppe estate.<br/><br/>This could be very useful for timing your movements through the basement.")
          this.hasBeenSearched = true
          AddToInventory (Guard Schedule)
        }
        else {
          msg ("A beautiful painting of the Austrian Alps in winter. It hangs slightly askew on the wall. The Baron notices your interest and shifts slightly, blocking your view of it.")
        }
      ]]></look>
    </object>
    <object name="Guard Schedule">
      <inherit name="editor_object" />
      <visible type="boolean">false</visible>
      <look><![CDATA[A detailed schedule showing guard rotations throughout the Giuseppe estate. Key information:<br/><br/>- Guards change shifts on the hour<br/>- The basement has reduced coverage during shift changes<br/>- The vault area is most vulnerable at midnight<br/><br/>This intelligence could be valuable for timing your movements.]]></look>
      <drop type="boolean">false</drop>
      <inventoryverbs type="stringlist">
        <value>Look at</value>
      </inventoryverbs>
    </object>
    <object name="Guest Registry Card">
      <inherit name="editor_object" />
      <isAltered type="boolean">false</isAltered>
      <look type="script"><![CDATA[
        if (this.isAltered) {
          msg ("The registry card now shows 'Chamber 1' instead of 'Chamber 2'. The Baron was quite confused when he noticed.")
        }
        else {
          msg ("A guest registry card on the nightstand. It reads:<br/><br/>\"Baron Friedrich von Stein - Chamber 2\"<br/><br/>These cards are used to help guests find their assigned rooms.")
        }
      ]]></look>
      <take />
      <drop type="boolean">false</drop>
      <inventoryverbs type="stringlist">
        <value>Look at</value>
        <value>Use</value>
      </inventoryverbs>
      <rewrite type="script"><![CDATA[
        if (this.isAltered) {
          msg ("You have already altered the registry card.")
        }
        else {
          msg ("You use the Shkruesiverita to change 'Chamber 2' to 'Chamber 1'.<br/><br/>You place the card prominently on the nightstand and wait. The Baron eventually glances at it and frowns.<br/><br/>Baron Friedrich: \"Chamber 1? But I thought... No, I must be mistaken. These Italian houses are so confusing.\"<br/><br/>He gathers some of his papers.<br/><br/>Baron Friedrich: \"Excuse me. I must find my correct room.\"<br/><br/>He leaves, looking puzzled. You are now alone in the bedchamber.")
          this.isAltered = true
          Baron Friedrich.isDistracted = true
        }
      ]]></rewrite>
    </object>
  </object>
  <object name="Bedchamber 3">
    <inherit name="editor_room" />
    <description><![CDATA[An artistic chamber filled with musical chaos. This room has been assigned to {object:Maestro Enzo}, Venice's most celebrated composer.<br/><br/>{object:Sheet Music} is scattered everywhere. A {object:Violin} rests on a chair, and a {object:Metronome} ticks steadily on the nightstand. A {object:Composition Journal} lies on the bed.]]></description>
    <exit alias="west" to="Ballroom Second Floor">
      <inherit name="westdirection" />
    </exit>
    <object name="Maestro Enzo">
      <inherit name="editor_object" />
      <inherit name="male" />
      <alias>Maestro Enzo Cardinali</alias>
      <isDistracted type="boolean">false</isDistracted>
      <hasHeardMelody type="boolean">false</hasHeardMelody>
      <look type="script">
        if (this.isDistracted) {
          msg ("The Maestro has left to perform in the Music Salon.")
        }
        else {
          msg ("An eccentric elderly man with wild white hair and ink-stained fingers. He hums to himself while scribbling musical notes on any available surface. He cups his ear when you approach - clearly hard of hearing.")
        }
      </look>
      <speak type="script"><![CDATA[
        if (this.isDistracted) {
          msg ("The Maestro is not here.")
        }
        else {
          msg ("The Maestro squints at you and cups his ear.")
          msg ("Maestro Enzo: \"Eh? What? Speak up!\"")
          topics = Split ("Are you the famous composer;What are you working on;Do you enjoy working for Giuseppe", ";")
          ShowMenu ("What would you like to say (loudly)?", topics, false) {
            switch (result) {
              case ("Are you the famous composer") {
                msg ("Maestro Enzo: \"Famous? BAH! I am a prisoner of my own genius! Everyone wants a piece of Enzo Cardinali!\"<br/><br/>He waves his hands dramatically.")
              }
              case ("What are you working on") {
                msg ("Maestro Enzo: \"A 'triumph' for our glorious host.\" He says this with barely concealed sarcasm. \"But my true notes - my important notes - I hide where only true musicians would find them.\"<br/><br/>He taps his nose mysteriously.")
              }
              case ("Do you enjoy working for Giuseppe") {
                msg ("The Maestro's expression darkens.<br/><br/>Maestro Enzo: \"Giuseppe CAGED my masterpiece. Locked away my greatest work because it did not flatter him enough. I am trapped here, composing lies.\"<br/><br/>He looks profoundly sad for a moment before returning to his manic energy.")
              }
            }
          }
        }
      ]]></speak>
    </object>
    <object name="Sheet Music">
      <inherit name="editor_object" />
      <alias>Sheet Music - Giuseppe's Triumph</alias>
      <look><![CDATA[Scattered sheet music for a piece titled "Giuseppe's Triumph." As you examine it, you notice certain notes have been circled in red ink:<br/><br/>C - A - G - E<br/><br/>The circled notes spell "CAGE." The Maestro mentioned being caged by Giuseppe... Perhaps this is a clue?]]></look>
    </object>
    <object name="Violin">
      <inherit name="editor_object" />
      <look>A beautiful violin resting on a velvet-cushioned chair. It looks well-used and clearly treasured by the Maestro.</look>
      <displayverbs type="stringlist">
        <value>Look at</value>
        <value>Play</value>
      </displayverbs>
      <play type="script"><![CDATA[
        if (Maestro Enzo.isDistracted) {
          msg ("With the Maestro gone, you could play freely, but there seems to be no need now.")
        }
        else {
          msg ("You pick up the violin. The Maestro watches with sudden interest, his hearing apparently sharp enough for music.")
          topics = Split ("Play C-A-G-E;Play a random melody;Play nothing and put it down", ";")
          ShowMenu ("What would you like to play?", topics, false) {
            switch (result) {
              case ("Play C-A-G-E") {
                msg ("You carefully play the notes C, A, G, and E in sequence.<br/><br/>The Maestro's eyes widen. Tears begin to form.<br/><br/>Maestro Enzo: \"That melody... that is from my caged masterpiece. How did you know?\"<br/><br/>He grasps your arm with surprising strength.<br/><br/>Maestro Enzo: \"You understand. You are a true musician. Giuseppe locked away my life's work because it spoke truth about his corruption. The third number of his vault combination - I saw it once - it is 2. Use it to expose him!\"<br/><br/>He releases you, looking drained but somehow lighter.")
                Maestro Enzo.hasHeardMelody = true
                set (player, "knowsVaultThirdDigit", true)
              }
              case ("Play a random melody") {
                msg ("You play a few random notes. The Maestro winces.<br/><br/>Maestro Enzo: \"BAH! That is not music! That is noise!\"<br/><br/>He waves you away irritably.<br/><br/>(Threat level increased)")
                game.threat = game.threat + 1
              }
              case ("Play nothing and put it down") {
                msg ("You carefully set the violin back down. The Maestro looks disappointed.")
              }
            }
          }
        }
      ]]></play>
    </object>
    <object name="Metronome">
      <inherit name="editor_object" />
      <isOpen type="boolean">false</isOpen>
      <look type="script">
        if (this.isOpen) {
          msg ("The metronome sits open, its hidden compartment revealed. Inside you found the third vault digit.")
        }
        else if (Maestro Enzo.isDistracted) {
          msg ("A brass metronome ticking steadily at 120 BPM. With the Maestro gone, you notice the base looks slightly loose, as if it conceals a hidden compartment.")
        }
        else {
          msg ("A brass metronome ticking steadily at 120 BPM. It sits on the nightstand, keeping perfect time.")
        }
      </look>
      <displayverbs type="stringlist">
        <value>Look at</value>
        <value>Open</value>
      </displayverbs>
      <open type="script"><![CDATA[
        if (this.isOpen) {
          msg ("You have already opened the metronome.")
        }
        else if (not Maestro Enzo.isDistracted) {
          msg ("You reach for the metronome but the Maestro slaps your hand away.<br/><br/>Maestro Enzo: \"Do not touch my instruments!\"<br/><br/>(Threat level increased)")
          game.threat = game.threat + 2
        }
        else {
          msg ("You examine the metronome's base and find a small hidden compartment. Inside is a folded piece of paper.<br/><br/>The paper reads: \"Third: 2\"<br/><br/>Beneath it, in the Maestro's handwriting: \"Giuseppe thinks he owns art itself. The combination to his vanity - the vault - I glimpsed it. Let someone worthy use this.\"")
          this.isOpen = true
          set (player, "knowsVaultThirdDigit", true)
        }
      ]]></open>
    </object>
    <object name="Composition Journal">
      <inherit name="editor_object" />
      <look type="script">
        if (Maestro Enzo.isDistracted) {
          msg ("A leather-bound journal filled with musical notations and bitter observations about Giuseppe. Among the pages you find a performance schedule.")
          MakeObjectVisible (Performance Schedule)
        }
        else {
          msg ("A thick leather-bound journal covered in musical notations. The Maestro guards it possessively.")
        }
      </look>
    </object>
    <object name="Performance Schedule">
      <inherit name="editor_object" />
      <visible type="boolean">false</visible>
      <isAltered type="boolean">false</isAltered>
      <look type="script"><![CDATA[
        if (this.isAltered) {
          msg ("The schedule now shows an immediate performance in the Music Salon. The Maestro has already left.")
        }
        else {
          msg ("A schedule of musical performances for the party. One entry shows:<br/><br/>\"Maestro Enzo Cardinali - Music Salon Performance - Midnight\"<br/><br/>That is still hours away...")
        }
      ]]></look>
      <take />
      <drop type="boolean">false</drop>
      <inventoryverbs type="stringlist">
        <value>Look at</value>
        <value>Use</value>
      </inventoryverbs>
      <rewrite type="script"><![CDATA[
        if (this.isAltered) {
          msg ("You have already altered the schedule.")
        }
        else {
          msg ("You use the Shkruesiverita to change the performance time to 'NOW - IMMEDIATELY'.<br/><br/>A servant knocks at the door moments later.<br/><br/>Servant: \"Maestro Cardinali? The guests are assembled in the Music Salon for your performance.\"<br/><br/>Maestro Enzo: \"What? Now? But I am not prepared!\"<br/><br/>Servant: \"The schedule says immediately, Maestro. They are waiting.\"<br/><br/>The Maestro grumbles but gathers his violin and shuffles out, muttering about incompetent schedulers.<br/><br/>You are now alone in the bedchamber.")
          this.isAltered = true
          Maestro Enzo.isDistracted = true
        }
      ]]></rewrite>
    </object>
  </object>
  <object name="Study">
    <inherit name="editor_room" />
    <description>A study, crowded with guests. Bookshelves line the walls of this study.</description>
    <exit alias="east" to="Ballroom Second Floor">
      <inherit name="eastdirection" />
    </exit>
    <object name="Poster">
      <inherit name="editor_object" />
      <useindividualverblist type="boolean">false</useindividualverblist>
      <displayverbs type="stringlist">
        <value>Look at</value>
      </displayverbs>
      <look>A poster showcasing the times of various events occuring during the party. There is a speech being held later later into the night by the host himself.</look>
      <isDistracted type="boolean">false</isDistracted>
      <rewrite type="script">
        msg ("You rewrite the time of the host's speech to be in only a couple of minutes. As the guests in the room take notice, they begin to leave, heading for the ballroom.")
        set (Poster, "isDistracted", true)
        RemoveObject (Poster)
      </rewrite>
    </object>
    <object name="Potted Plant">
      <inherit name="editor_object" />
      <lookunder type="script">
        if (Poster.isDistracted) {
          AddToInventory (Shining Key)
          msg ("There was a shiny key underneath the potted plant. It would be hard to hide from people looking at you.")
          this.isDistracted = false
        }
        else {
          msg ("It would be suspicious to do so while people are nearby.")
        }
      </lookunder>
    </object>
    <object name="Books">
      <inherit name="editor_object" />
      <useindividualverblist type="boolean">false</useindividualverblist>
      <displayverbs type="stringlist">
        <value>Look at</value>
      </displayverbs>
      <look type="script"><![CDATA[
        msg ("You see a number of books spread out along the shelves, free to be taken and read.")
        topics = Split ("Read green book;Read blue book;Read red book;Walk away", ";")
        ShowMenu ("What would you like to do?", topics, false) {
          switch (result) {
            case ("Read green book") {
              msg ("A novel on the design of set-pieces, how meaningless details can contribute to the stories they take part in.")
            }
            case ("Read blue book") {
              msg ("A book on better ways to spend your time, encouraging meaningful hobbies and better time management skills.")
            }
            case ("Read red book") {
              msg ("You hear something move as you pick up the book, and as you skim the pages, you notice it is entirely blank.")
              set (Secret Passage, "visible", true)
              if (Poster.isDistracted = false) {
                game.threat = game.threat + 2
                if (game.threat >= 10) {
                  msg ("You now have guards chasing after you. You have 2 actions before they grab you.")
                }
              }
            }
            case ("Walk away") {
              msg ("You walk away.")
            }
          }
        }
      ]]></look>
    </object>
    <object name="Secret Passage">
      <inherit name="editor_object" />
      <visible type="boolean">false</visible>
      <look>A small, narrow passage looking directly into the bathroom on the other side. You question the intent of installing such a thing.</look>
      <displayverbs type="stringlist">
        <value>Look at</value>
      </displayverbs>
      <putitemthrough type="scriptdictionary">
        <item key="Shining Key">
          MoveObject (Shining Key, Bathroom)
        </item>
      </putitemthrough>
    </object>
  </object>
  <object name="Bathroom">
    <inherit name="editor_room" />
    <description><![CDATA[The Bathroom of the Giuseppe estate's second floor. Even for such a room there are many expensive items and decorations around. <br/><br/>This room also appears to be connected to the Master Bedroom of this estate...]]></description>
    <exit alias="northeast" to="Ballroom Second Floor">
      <inherit name="northeastdirection" />
    </exit>
    <exit name="Master Bedroom Entrance" alias="east" to="Master Bedroom">
      <inherit name="eastdirection" />
      <locked type="boolean">false</locked>
      <runscript />
      <isOpened type="boolean">false</isOpened>
      <script type="script">
        if (Got(Shining Key) or this.isOpened) {
          this.isOpened = true
          MovePlayer (Master Bedroom)
          RemoveObject (Shining Key)
        }
        else {
          msg ("The door is locked")
        }
      </script>
    </exit>
  </object>
  <object name="Master Bedroom">
    <inherit name="editor_room" />
    <exit alias="north" to="Ballroom Second Floor">
      <inherit name="northdirection" />
      <locked type="boolean">false</locked>
      <runscript />
      <script type="script"><![CDATA[
        if (game.threat < 10) {
          msg ("As you open the door, you reveal yourself to everyone in the ballroom, and they realize that you are an intruder.")
          game.threat = 10
        }
        MovePlayer (Ballroom Second Floor)
      ]]></script>
    </exit>
    <exit alias="west" to="Bathroom">
      <inherit name="westdirection" />
    </exit>
    <object name="Bedside Desk">
      <inherit name="editor_object" />
      <look type="script">
        msg ("You search the desk, and find a piece of paper neatly folded underneath a lamp. It has \"First: 5\" written on it.")
        set (player, "knowsVaultFirstDigit", true)
      </look>
    </object>
  </object>
  <object name="Lounge">
    <inherit name="editor_room" />
    <exit alias="northwest" to="Ballroom Second Floor">
      <inherit name="northwestdirection" />
    </exit>
  </object>
  <object name="Basement Entrance">
    <inherit name="editor_room" />
    <exit alias="up" to="Kitchen">
      <inherit name="updirection" />
    </exit>
    <exit alias="southwest" to="Basement Main">
      <inherit name="southwestdirection" />
    </exit>
  </object>
  <object name="Wine Cellar">
    <inherit name="editor_room" />
    <exit alias="northwest" to="Basement Main">
      <inherit name="northwestdirection" />
    </exit>
  </object>
  <object name="Basement Main">
    <inherit name="editor_room" />
    <exit alias="northeast" to="Basement Entrance">
      <inherit name="northeastdirection" />
    </exit>
    <exit alias="southeast" to="Wine Cellar">
      <inherit name="southeastdirection" />
    </exit>
    <exit alias="southwest" to="Dungeon">
      <inherit name="southwestdirection" />
    </exit>
    <exit alias="northwest" to="Canals Exit">
      <inherit name="northwestdirection" />
    </exit>
    <exit alias="south" to="Vault Room">
      <inherit name="southdirection" />
      <locked type="boolean">false</locked>
      <runscript />
      <script type="script"><![CDATA[
        msg ("You approach the Vault Door. It is tightly closed and sealed. To the side is a ten digit number pad with four spaces for the input.")
        topics = Split ("1234;2839;4539;5283;5478", ";")
        ShowMenu ("What combination do you want to try", topics, false) {
          switch (result) {
            case ("1234") {
              msg ("You attempt to put in the combination 1-2-3-4...<br/><br/>You hear an incorrect sounding buzzer beep ring somewhat loudly. <br/><br/>(Threat Increased)")
              game.threat = game.threat + 3
            }
            case ("2839") {
              msg ("You attempt to put in the combination 2-8-3-9<br/><br/>You hear an incorrect sounding buzzer beep ring somewhat loudly. <br/><br/>(Threat Increased)")
              game.threat = game.threat + 3
            }
            case ("4539") {
              msg ("You attempt to put in the combination 4-5-3-9...<br/><br/>You hear an incorrect sounding buzzer beep ring somewhat loudly. <br/><br/>(Threat Increased)")
              game.threat = game.threat + 3
            }
            case ("5283") {
              msg ("You attempt to put in the combination 5-2-8-3...<br/><br/>You hear an incorrect sounding buzzer beep ring somewhat loudly. <br/><br/>(Threat Increased)")
              game.threat = game.threat + 3
            }
            case ("5478") {
              msg ("You attempt to put in the combination 1-2-3-4...<br/><br/>You hear an incorrect sounding buzzer beep ring somewhat loudly. <br/><br/>(Threat Increased)")
              game.threat = game.threat + 3
            }
          }
        }
        if (player.knowsVaultFirstDigit and player.knowsVaultSecondDigit and player.knowsVaultThirdDigit and player.knowsVaultLastDigit) {
          unlockedoptions = Split ("5723", ";")
          ShowMenu ("Unlocked Option:", unlockedoptions, false) {
            switch (result) {
              case ("5723") {
                msg ("You attempt to put in the combination 5-7-2-3..<br/><br/>You hear a correct sounding buzzer beep followed by a clicking sound... <br/><br/>You turn the handle on the vault door and pull it open<br/><br/>You have successfully made it into the Giuseppe estate's coveted vault")
                MovePlayer (Vault Room)
              }
            }
          }
        }
        else if (player.knowsVaultFirstDigit and player.knowsVaultLastDigit) {
          msg ("You know the first digit is 5 and the last digit is 3, but you still need to discover the middle two digits before you can attempt the full combination.")
        }
        else if (player.knowsVaultFirstDigit or player.knowsVaultSecondDigit or player.knowsVaultThirdDigit or player.knowsVaultLastDigit) {
          msg ("You have discovered some digits of the vault combination, but not all four. Keep searching for clues.")
        }
      ]]></script>
    </exit>
  </object>
  <object name="Canals Exit">
    <inherit name="editor_room" />
    <description><![CDATA[In the back of the estate there is an exit to the canals. Travel by boat is commonplace in Venice after all. You can see various boats around this place.<br/><br/>You see a {object:Canals Guard} Standing near the edge of the canal.]]></description>
    <exit alias="southeast" to="Basement Main">
      <inherit name="southeastdirection" />
    </exit>
    <object name="Canals Guard">
      <inherit name="editor_object" />
      <inherit name="male" />
      <distracted type="boolean">false</distracted>
      <lookedAt type="boolean">false</lookedAt>
      <knockedOut type="boolean">false</knockedOut>
      <speak type="script"><![CDATA[
        if (game.threat > 4 and not this.distracted and not this.knockedOut) {
          msg ("Your threat level is too high. Conversing with the guard will surely lead to trouble")
        }
        else if (this.distracted and not this.knockedOut) {
          msg ("The guard is distracted. You shouldn't speak with him now.")
        }
        else if (this.knockedOut) {
          msg ("He is knocked out. He cannot speak to you like this. ")
        }
        else {
          topics = Split ("How are you doing;What is your name;Aren't you supposed to have a coat", ";")
          ShowMenu ("What do you want to say?", topics, false) {
            switch (result) {
              case ("How are you doing") {
                msg ("Guard: \"Fine. This party is very big and loud. I prefer the quiet here.\"<br/><br/>He puts the cigarette to his mouth...")
              }
              case ("What is your name") {
                msg ("You introduce yourself and ask his name while extending a hand to shake.<br/><br/>Guard: \"I am Marco Romano\"<br/><br/>He shakes your hand")
                set (player, "knowsCoatGuardName", true)
              }
              case ("Aren;t you supposed to have a coat") {
                msg ("Canals Guard: \"I was taking a break in the party. I left it at the coat check-in. I suppose I forgot to get it\"")
              }
            }
          }
        }
      ]]></speak>
      <look type="script">
        if (this.distracted) {
          msg ("You see a guard looking over the edge of the canals to the water.  He is strangely missing his coat. He has a cigarette in his hand. He appears to also have a letter in his pocket.")
        }
        else if (this.knockedOut) {
          msg ("The guard is knocked out.")
        }
        else {
          msg ("You see a guard standing close to the edge of the water. He is strangely missing his coat. He is smoking a cigarette. He appears to also have a letter in his pocket.")
        }
        set (Canals Guard, "lookedAt", true)
      </look>
      <steal type="script"><![CDATA[
        if (this.lookedAt and not this.knockedOut) {
          msg ("You see the letter in his pocket, but it would be too risky to try and steal it now.You will need to knock him out somehow...")
        }
        else if (this.lookedAt and this.knockedOut) {
          msg ("You manage to take the letter he had.<br/><br/>It displays his name clearly, \"To Marco Romano\"<br/><br/>You get all the information you need so you carefully put the letter back in his pocket.")
          set (player, "knowsCoatGuardName", true)
        }
        else if (not this.lookedAt and this.knockedOut) {
          msg ("Your ruffle through the pockets of the Guard. In one of them you find a letter.<br/><br/>It displays his name clearly, \"To Marco Romano\"<br/><br/>You get all the information you need so you carefully put the letter back in his pocket.")
        }
        else {
          msg ("You wouldn't know what to steal from him without looking at him. It would also be too risky to try and steal from a guard like this.")
        }
      ]]></steal>
    </object>
    <object name="Ball">
      <inherit name="editor_object" />
      <look>It is a ball used to play sports.</look>
      <drop type="boolean">false</drop>
      <inventoryverbs type="stringlist">
        <value>Look at</value>
        <value>Use</value>
      </inventoryverbs>
      <displayverbs type="stringlist">
        <value>Look at</value>
      </displayverbs>
      <throw type="script">
        msg ("You toss the ball into the water of the canals. The guard is distracted by the sound of the splashing water.")
        set (Canals Guard, "distracted", true)
      </throw>
    </object>
    <object name="Spare Boat Oar">
      <inherit name="editor_object" />
      <look>It is an oar used to ferry many of the boats around Venice. It is large and made out of wood. A sturdy tool that can knock someone out very easily.</look>
      <inventoryverbs type="stringlist">
        <value>Look at</value>
        <value>Use</value>
      </inventoryverbs>
      <feature_usegive />
      <take type="boolean">false</take>
      <takemsg>You pick on the Spare Boat oar</takemsg>
      <drop type="boolean">false</drop>
      <use />
      <ontake type="script">
        AddToInventory (Spare Boat Oar)
      </ontake>
      <selfuseon type="scriptdictionary">
        <item key="Canals Guard"><![CDATA[
          if (Canals Guard.distracted) {
            msg ("You use the Spare Boat Oar to knock the Canals Guard out<br/><br/>He is knocked out cold, but he is still alive.")
            set (Canals Guard, "knockedOut", true)
          }
          else {
            msg ("It would be too risky to try and knock him out now. He would need to be distracted first.")
          }
        ]]></item>
      </selfuseon>
    </object>
  </object>
  <object name="Dungeon">
    <inherit name="editor_room" />
    <description><![CDATA[In the Basement of the Guisseppe Estate you find a Dungeon. This estate is clearly from times of old to have such a place. You have no doubt in your mind that countless people have found themselves in this very room for going against the Giusseppe Family. <br/><br/>The eerie nature of the room makes you cautious. There are some locked rooms.]]></description>
    <exit alias="northeast" to="Basement Main">
      <inherit name="northeastdirection" />
    </exit>
    <object name="Dungeon Prisoner">
      <inherit name="editor_object" />
      <inherit name="male" />
      <look>You see the man kept inside the dungeon room. You can see slight bruises on his arms. His coat is torn and battered. He appears to be a middle-aged man with a beard and unkempt hair. </look>
      <askedWhyHere type="boolean">false</askedWhyHere>
      <isFree type="boolean">false</isFree>
      <speak type="script"><![CDATA[
        msg ("You approach the Dungeon Prisoner")
        topics = Split ("Are you ok;What is your name;Why are you in here", ";")
        ShowMenu ("What do you want to ask?", topics, false) {
          switch (result) {
            case ("What is your name") {
              msg ("Dungeon Prisoner: \"I am Antonio De Luca\"")
            }
            case ("Why are you in here") {
              msg ("Dungeon Prisoner: \"I'm in here because I dared to go up against Guido Giusseppe.\"<br/><br/>He sighs...<br/><br/>Dungeon Prisoner: \"Guido Giusseppe is a corrupt monster who will do anything to stay in power. He was going to destroy my business and leave me in ruin. We used to be business partners, before I realized his corruptness and thirst for power. I heard he was hosting this party and came to confront him. He did not care at all. He ordered one of his men to send me down here, and here I am. I know a few of his secrets. Perhaps that is why I am down here.\"<br/><br/>You feel a sense of sympathy for this man.<br/><br/>You might want to ask what secrets he knows...")
              set (Dungeon Prisoner, "askedWhyHere", true)
            }
            case ("Are you ok") {
              msg ("Duneon Prisoner: \"I am in quite a bit of pain after the guards subdued me. I did not go down without a fight. I just want to get out of here and go home.\"")
            }
          }
        }
        if (this.askedWhyHere) {
          unlockedOptions = Split ("What secrets do you know;", ";")
          ShowMenu ("Unlocked Dialogue Options:", unlockedOptions, false) {
            switch (result) {
              case ("What secrets do you know") {
                msg ("Dungeon Prisoner: \"I know the corrupt actions he has taken to rise to power. I know where he likes to visit and the people he speaks to. Nothing of use I suppose... Though I do know a digit for the combination of that Vault you might have seen. I was down here with him before and a managed to catch a glimpse. I can tell you it if you help get me out of here.\"<br/><br/>You are intrigued...<br/><br/>Dungeon Prisoner: \"The guard that put me in here left the key inside the pocket of his coat. He also mentioned he was taking a break to linger around the party. Though I think I heard him near here somewhere. He can get quite loud. Maybe you can get that key somehow?\"")
              }
            }
          }
        }
      ]]></speak>
    </object>
  </object>
  <object name="Vault Room">
    <inherit name="editor_room" />
    <description><![CDATA[The Vault Room of the Giusseppe estate. It has many prized possesions that are worth millions alone. <br/><br/>You are only here to get the documents that ruined your family name and deligitemize their contents.]]></description>
    <exit alias="north" to="Basement Main">
      <inherit name="northdirection" />
    </exit>
    <object name="Filing Cabinet">
      <inherit name="editor_object" />
      <inherit name="container_open" />
      <look>You see a filing cabinet in the corner of the room. There are various drawers containing all sorts of documents and papers.</look>
      <feature_container />
      <onopen type="script"><![CDATA[
        msg ("You look through the various drawers in the Filing Cabinet<br/><br/>After some time looking through the various documents, you find what you are looking for.<br/><br/>You pull out the very documents that have ruined your family's name. Guido Giusseppe's corrupt actions have produced these falsified documents.<br/><br/>You now have them in your hands...")
        AddToInventory (Forger Family Documents)
      ]]></onopen>
      <displayverbs type="stringlist">
        <value>Look at</value>
        <value>Open</value>
        <value>Close</value>
      </displayverbs>
      <isopen type="boolean">false</isopen>
      <object name="Forger Family Documents">
        <inherit name="editor_object" />
        <look>The very documents that led to the downfall of your family's status. You now have the fate of your family in your hands.</look>
        <inventoryverbs type="stringlist">
          <value>Look at</value>
        </inventoryverbs>
        <displayverbs type="stringlist">
          <value>Look at</value>
        </displayverbs>
        <drop type="boolean">false</drop>
        <take />
      </object>
    </object>
  </object>
  <verb>
    <property>steal</property>
    <pattern>steal</pattern>
    <defaultexpression>WriteVerb(game.pov, "can't") + " steal " + object.article + "."</defaultexpression>
  </verb>
  <verb>
    <property>lookunder</property>
    <pattern>look under</pattern>
    <defaultexpression>WriteVerb(game.pov, "can't") + " look under " + object.article + "."</defaultexpression>
  </verb>
  <verb>
    <property>rewrite</property>
    <pattern>rewrite</pattern>
    <defaultexpression>WriteVerb(game.pov, "can't") + " rewrite " + object.article + "."</defaultexpression>
  </verb>
  <verb>
    <property>putshinykeythrough</property>
    <pattern>put shiny key through</pattern>
    <defaultexpression>WriteVerb(game.pov, "can't") + " put shiny key through " + object.article + "."</defaultexpression>
  </verb>
  <verb>
    <property>putitemthrough</property>
    <pattern>put item through</pattern>
    <defaultexpression>WriteVerb(game.pov, "can't") + " put item through " + object.article + "."</defaultexpression>
  </verb>
  <verb>
    <property>search</property>
    <pattern>search</pattern>
    <defaultexpression>WriteVerb(game.pov, "can't") + " search " + object.article + "."</defaultexpression>
  </verb>
  <verb>
    <property>open</property>
    <pattern>open</pattern>
    <defaultexpression>WriteVerb(game.pov, "can't") + " open " + object.article + "."</defaultexpression>
  </verb>
  <verb>
    <property>play</property>
    <pattern>play</pattern>
    <defaultexpression>WriteVerb(game.pov, "can't") + " play " + object.article + "."</defaultexpression>
  </verb>
  <turnscript name="Guard Check">
    <enabled />
    <script>
      if (game.threat = 10) {
        if (game.guardTimer = 0) {
          undo
          msg ("The guards would catch you if you stayed any longer")
        }
        else {
          game.guardTimer = game.guardTimer - 1
          msg ("You have " + game.guardTimer + " turn(s) left")
        }
      }
    </script>
  </turnscript>
</asl>
